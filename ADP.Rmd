---
title: "ADP"
author: "Shaina Mackin"
date: "2/20/2022"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
library(ggplot2)
```

```{r import}
adp_df = read_excel("./data/juvenile_adp.xlsx", col_types = "text") 
```

```{r tidy}
adp_girls = adp_df %>%
  janitor::clean_names() %>%
  mutate(
    adp_pre_disposition_female = replace(adp_pre_disposition_female, adp_pre_disposition_female == "D", 0),
    adp_pre_disposition_female = replace(adp_pre_disposition_female, adp_pre_disposition_female == "d", 0),
     adp_pre_disposition_female = replace(adp_pre_disposition_female, adp_pre_disposition_female == "u", 0),
     adp_post_disposition_female = replace(adp_post_disposition_female, adp_post_disposition_female == "D", 0),
     adp_post_disposition_female = replace(adp_post_disposition_female, adp_post_disposition_female == "d", 0),
    adp_post_disposition_female = replace(adp_post_disposition_female, adp_post_disposition_female == "u", 0),
  ) %>%
  select(county, year, month, adp_pre_disposition_female, adp_post_disposition_female) %>%
  mutate(
    adp_pre_disposition_female = as.numeric(adp_pre_disposition_female),
    adp_post_disposition_female = as.numeric(adp_post_disposition_female)) %>%
  mutate(
    total_female = adp_pre_disposition_female + adp_post_disposition_female) %>%
    group_by(county, year, month) %>%
  summarise(
    adp_pre_disposition_female = sum(adp_pre_disposition_female),
    adp_post_disposition_female = sum(adp_post_disposition_female),
    total_female = sum(total_female)) %>%
  mutate(
    year = as.numeric(unlist(year)),
    month = as.numeric(unlist(month)),
    day = "01"
    ) %>%
  mutate(
    month = formatC(as.numeric(month), width=2,format='f',digits = 0, flag='0') 
  ) %>%
  select(county, day, month, year, total_female) %>%
  unite('the_date', day:year, remove = TRUE) %>%
  mutate(
    the_date = str_replace(the_date, "_", "\\")
  ) %>%
   mutate(
    the_date = str_replace(the_date, "_", "\\")
  ) %>%
  select(county, the_date, total_female) %>%
  mutate(
    the_date = lubridate::mdy(the_date)
  )

```


```{r chart}
adp_girls %>%
  ggplot(aes(x = date, y = total_female, color = county)) +
  geom_point()

```

